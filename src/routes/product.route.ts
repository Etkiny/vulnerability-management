import { Router } from 'express';
import { product as productController } from '../controllers';
import { validator as validatorMiddleware } from '../middlewares';
import { product as productValidation } from '../validations';

const route = Router();

route.post(
    '/',
    validatorMiddleware.requestValidator(productValidation.addUserProduct),
    productController.addUserProduct
);
route.get(
    '/:userNumber',
    validatorMiddleware.requestValidator(productValidation.getUserProducts),
    productController.getUserProducts
);
route.get('/allProducts', productController.listAllProducts);
route.get(
    '/vulnerabilities/:productNumber',
    validatorMiddleware.requestValidator(productValidation.getUserProductVulnerabilities),
    productController.getUserProductVulnerabilities
);

export default route;
